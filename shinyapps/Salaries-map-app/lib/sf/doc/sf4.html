<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Edzer Pebesma" />


<title>4. Manipulating Simple Features</title>


<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">4. Manipulating Simple Features</h1>
<h4 class="author">Edzer Pebesma</h4>



<p><strong>For a better version of the sf vignettes see</strong> <a href="https://r-spatial.github.io/sf/articles/" class="uri">https://r-spatial.github.io/sf/articles/</a></p>
<p>This vignette describes how simple features, i.e.Â records that come with a geometry, can be manipulated, for the case where these manipulations involve geometries. Manipulations include:</p>
<ul>
<li>aggregating feature sets</li>
<li>summarising feature sets</li>
<li>joining two feature sets based on feature geometry</li>
</ul>
<p>Features are represented by records in an <code>sf</code> object, and have feature attributes (all non-geometry fields) and feature geometry. Since <code>sf</code> objects are a subclass of <code>data.frame</code> or <code>tbl_df</code>, operations on feature attributes work identical to how they work on <code>data.frame</code>s, e.g.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="kw">library</span>(sf)</a>
<a class="sourceLine" id="cb1-2" title="2">nc &lt;-<span class="st"> </span><span class="kw">st_read</span>(<span class="kw">system.file</span>(<span class="st">&quot;shape/nc.shp&quot;</span>, <span class="dt">package=</span><span class="st">&quot;sf&quot;</span>))</a>
<a class="sourceLine" id="cb1-3" title="3"><span class="co">## Reading layer `nc&#39; from data source `/tmp/Rtmpl6EaFo/Rinst6231414d3e82f/sf/shape/nc.shp&#39; using driver `ESRI Shapefile&#39;</span></a>
<a class="sourceLine" id="cb1-4" title="4"><span class="co">## Simple feature collection with 100 features and 14 fields</span></a>
<a class="sourceLine" id="cb1-5" title="5"><span class="co">## Geometry type: MULTIPOLYGON</span></a>
<a class="sourceLine" id="cb1-6" title="6"><span class="co">## Dimension:     XY</span></a>
<a class="sourceLine" id="cb1-7" title="7"><span class="co">## Bounding box:  xmin: -84.32385 ymin: 33.88199 xmax: -75.45698 ymax: 36.58965</span></a>
<a class="sourceLine" id="cb1-8" title="8"><span class="co">## Geodetic CRS:  NAD27</span></a>
<a class="sourceLine" id="cb1-9" title="9">nc &lt;-<span class="st"> </span><span class="kw">st_transform</span>(nc, <span class="dv">2264</span>)</a>
<a class="sourceLine" id="cb1-10" title="10">nc[<span class="dv">1</span>,]</a>
<a class="sourceLine" id="cb1-11" title="11"><span class="co">## Simple feature collection with 1 feature and 14 fields</span></a>
<a class="sourceLine" id="cb1-12" title="12"><span class="co">## Geometry type: MULTIPOLYGON</span></a>
<a class="sourceLine" id="cb1-13" title="13"><span class="co">## Dimension:     XY</span></a>
<a class="sourceLine" id="cb1-14" title="14"><span class="co">## Bounding box:  xmin: 1193283 ymin: 913341.9 xmax: 1340555 ymax: 1044158</span></a>
<a class="sourceLine" id="cb1-15" title="15"><span class="co">## Projected CRS: NAD83 / North Carolina (ftUS)</span></a>
<a class="sourceLine" id="cb1-16" title="16"><span class="co">##    AREA PERIMETER CNTY_ CNTY_ID NAME  FIPS FIPSNO CRESS_ID BIR74 SID74 NWBIR74</span></a>
<a class="sourceLine" id="cb1-17" title="17"><span class="co">## 1 0.114     1.442  1825    1825 Ashe 37009  37009        5  1091     1      10</span></a>
<a class="sourceLine" id="cb1-18" title="18"><span class="co">##   BIR79 SID79 NWBIR79                       geometry</span></a>
<a class="sourceLine" id="cb1-19" title="19"><span class="co">## 1  1364     0      19 MULTIPOLYGON (((1270814 913...</span></a></code></pre></div>
<p>prints the first record.</p>
<p>Many of the tidyverse/dplyr verbs have methods for <code>sf</code> objects. This means that given that both <code>sf</code> and <code>dplyr</code> are loaded, manipulations such as selecting a single attribute will return an <code>sf</code> object:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1"><span class="kw">library</span>(dplyr)</a>
<a class="sourceLine" id="cb2-2" title="2">nc <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(NWBIR74) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">head</span>(<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb2-3" title="3"><span class="co">## Simple feature collection with 2 features and 1 field</span></a>
<a class="sourceLine" id="cb2-4" title="4"><span class="co">## Geometry type: MULTIPOLYGON</span></a>
<a class="sourceLine" id="cb2-5" title="5"><span class="co">## Dimension:     XY</span></a>
<a class="sourceLine" id="cb2-6" title="6"><span class="co">## Bounding box:  xmin: 1193283 ymin: 913341.9 xmax: 1441003 ymax: 1044158</span></a>
<a class="sourceLine" id="cb2-7" title="7"><span class="co">## Projected CRS: NAD83 / North Carolina (ftUS)</span></a>
<a class="sourceLine" id="cb2-8" title="8"><span class="co">##   NWBIR74                       geometry</span></a>
<a class="sourceLine" id="cb2-9" title="9"><span class="co">## 1      10 MULTIPOLYGON (((1270814 913...</span></a>
<a class="sourceLine" id="cb2-10" title="10"><span class="co">## 2      10 MULTIPOLYGON (((1340555 959...</span></a></code></pre></div>
<p>which implies that the geometry is sticky, and gets added automatically. If we want to drop geometry, we can coerce to <code>data.frame</code> first, this drops geometry list-columns:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1">nc <span class="op">%&gt;%</span><span class="st"> </span>as.data.frame <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(NWBIR74) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">head</span>(<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb3-2" title="2"><span class="co">##   NWBIR74</span></a>
<a class="sourceLine" id="cb3-3" title="3"><span class="co">## 1      10</span></a>
<a class="sourceLine" id="cb3-4" title="4"><span class="co">## 2      10</span></a></code></pre></div>
<div id="subsetting-feature-sets" class="section level2">
<h2>Subsetting feature sets</h2>
<p>We can subset feature sets by using the square bracket notation</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1">nc[<span class="dv">1</span>, <span class="st">&quot;NWBIR74&quot;</span>]</a>
<a class="sourceLine" id="cb4-2" title="2"><span class="co">## Simple feature collection with 1 feature and 1 field</span></a>
<a class="sourceLine" id="cb4-3" title="3"><span class="co">## Geometry type: MULTIPOLYGON</span></a>
<a class="sourceLine" id="cb4-4" title="4"><span class="co">## Dimension:     XY</span></a>
<a class="sourceLine" id="cb4-5" title="5"><span class="co">## Bounding box:  xmin: 1193283 ymin: 913341.9 xmax: 1340555 ymax: 1044158</span></a>
<a class="sourceLine" id="cb4-6" title="6"><span class="co">## Projected CRS: NAD83 / North Carolina (ftUS)</span></a>
<a class="sourceLine" id="cb4-7" title="7"><span class="co">##   NWBIR74                       geometry</span></a>
<a class="sourceLine" id="cb4-8" title="8"><span class="co">## 1      10 MULTIPOLYGON (((1270814 913...</span></a></code></pre></div>
<p>and use the <code>drop</code> argument to drop geometries:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1">nc[<span class="dv">1</span>, <span class="st">&quot;NWBIR74&quot;</span>, drop =<span class="st"> </span><span class="ot">TRUE</span>]</a>
<a class="sourceLine" id="cb5-2" title="2"><span class="co">## [1] 10</span></a>
<a class="sourceLine" id="cb5-3" title="3"><span class="co">## attr(,&quot;class&quot;)</span></a>
<a class="sourceLine" id="cb5-4" title="4"><span class="co">## [1] &quot;numeric&quot;</span></a></code></pre></div>
<p>but we can also use a spatial object as the row selector, to select features that intersect with another spatial feature:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1">Ashe =<span class="st"> </span>nc[nc<span class="op">$</span>NAME <span class="op">==</span><span class="st"> &quot;Ashe&quot;</span>,]</a>
<a class="sourceLine" id="cb6-2" title="2"><span class="kw">class</span>(Ashe)</a>
<a class="sourceLine" id="cb6-3" title="3"><span class="co">## [1] &quot;sf&quot;         &quot;data.frame&quot;</span></a>
<a class="sourceLine" id="cb6-4" title="4">nc[Ashe,]</a>
<a class="sourceLine" id="cb6-5" title="5"><span class="co">## Simple feature collection with 4 features and 14 fields</span></a>
<a class="sourceLine" id="cb6-6" title="6"><span class="co">## Geometry type: MULTIPOLYGON</span></a>
<a class="sourceLine" id="cb6-7" title="7"><span class="co">## Dimension:     XY</span></a>
<a class="sourceLine" id="cb6-8" title="8"><span class="co">## Bounding box:  xmin: 1142157 ymin: 823092 xmax: 1448920 ymax: 1044158</span></a>
<a class="sourceLine" id="cb6-9" title="9"><span class="co">## Projected CRS: NAD83 / North Carolina (ftUS)</span></a>
<a class="sourceLine" id="cb6-10" title="10"><span class="co">##     AREA PERIMETER CNTY_ CNTY_ID      NAME  FIPS FIPSNO CRESS_ID BIR74 SID74</span></a>
<a class="sourceLine" id="cb6-11" title="11"><span class="co">## 1  0.114     1.442  1825    1825      Ashe 37009  37009        5  1091     1</span></a>
<a class="sourceLine" id="cb6-12" title="12"><span class="co">## 2  0.061     1.231  1827    1827 Alleghany 37005  37005        3   487     0</span></a>
<a class="sourceLine" id="cb6-13" title="13"><span class="co">## 18 0.199     1.984  1874    1874    Wilkes 37193  37193       97  3146     4</span></a>
<a class="sourceLine" id="cb6-14" title="14"><span class="co">## 19 0.081     1.288  1880    1880   Watauga 37189  37189       95  1323     1</span></a>
<a class="sourceLine" id="cb6-15" title="15"><span class="co">##    NWBIR74 BIR79 SID79 NWBIR79                       geometry</span></a>
<a class="sourceLine" id="cb6-16" title="16"><span class="co">## 1       10  1364     0      19 MULTIPOLYGON (((1270814 913...</span></a>
<a class="sourceLine" id="cb6-17" title="17"><span class="co">## 2       10   542     3      12 MULTIPOLYGON (((1340555 959...</span></a>
<a class="sourceLine" id="cb6-18" title="18"><span class="co">## 18     200  3725     7     222 MULTIPOLYGON (((1402677 837...</span></a>
<a class="sourceLine" id="cb6-19" title="19"><span class="co">## 19      17  1775     1      33 MULTIPOLYGON (((1171158 868...</span></a></code></pre></div>
<p>we see that in the result set <code>Ashe</code> is included, as the default value for argument <code>op</code> in <code>[.sf</code> is <code>st_intersects</code>, and <code>Ashe</code> intersects with itself. We could exclude self-intersection by using predicate <code>st_touches</code> (overlapping features donât touch):</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1">Ashe =<span class="st"> </span>nc[nc<span class="op">$</span>NAME <span class="op">==</span><span class="st"> &quot;Ashe&quot;</span>,]</a>
<a class="sourceLine" id="cb7-2" title="2">nc[Ashe, op =<span class="st"> </span>st_touches]</a>
<a class="sourceLine" id="cb7-3" title="3"><span class="co">## Simple feature collection with 3 features and 14 fields</span></a>
<a class="sourceLine" id="cb7-4" title="4"><span class="co">## Geometry type: MULTIPOLYGON</span></a>
<a class="sourceLine" id="cb7-5" title="5"><span class="co">## Dimension:     XY</span></a>
<a class="sourceLine" id="cb7-6" title="6"><span class="co">## Bounding box:  xmin: 1142157 ymin: 823092 xmax: 1448920 ymax: 1035641</span></a>
<a class="sourceLine" id="cb7-7" title="7"><span class="co">## Projected CRS: NAD83 / North Carolina (ftUS)</span></a>
<a class="sourceLine" id="cb7-8" title="8"><span class="co">##     AREA PERIMETER CNTY_ CNTY_ID      NAME  FIPS FIPSNO CRESS_ID BIR74 SID74</span></a>
<a class="sourceLine" id="cb7-9" title="9"><span class="co">## 2  0.061     1.231  1827    1827 Alleghany 37005  37005        3   487     0</span></a>
<a class="sourceLine" id="cb7-10" title="10"><span class="co">## 18 0.199     1.984  1874    1874    Wilkes 37193  37193       97  3146     4</span></a>
<a class="sourceLine" id="cb7-11" title="11"><span class="co">## 19 0.081     1.288  1880    1880   Watauga 37189  37189       95  1323     1</span></a>
<a class="sourceLine" id="cb7-12" title="12"><span class="co">##    NWBIR74 BIR79 SID79 NWBIR79                       geometry</span></a>
<a class="sourceLine" id="cb7-13" title="13"><span class="co">## 2       10   542     3      12 MULTIPOLYGON (((1340555 959...</span></a>
<a class="sourceLine" id="cb7-14" title="14"><span class="co">## 18     200  3725     7     222 MULTIPOLYGON (((1402677 837...</span></a>
<a class="sourceLine" id="cb7-15" title="15"><span class="co">## 19      17  1775     1      33 MULTIPOLYGON (((1171158 868...</span></a></code></pre></div>
<p>using <code>dplyr</code>, we can do the same by calling the predicate directly:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1">nc <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">lengths</span>(<span class="kw">st_touches</span>(., Ashe)) <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>)</a>
<a class="sourceLine" id="cb8-2" title="2"><span class="co">## Simple feature collection with 3 features and 14 fields</span></a>
<a class="sourceLine" id="cb8-3" title="3"><span class="co">## Geometry type: MULTIPOLYGON</span></a>
<a class="sourceLine" id="cb8-4" title="4"><span class="co">## Dimension:     XY</span></a>
<a class="sourceLine" id="cb8-5" title="5"><span class="co">## Bounding box:  xmin: 1142157 ymin: 823092 xmax: 1448920 ymax: 1035641</span></a>
<a class="sourceLine" id="cb8-6" title="6"><span class="co">## Projected CRS: NAD83 / North Carolina (ftUS)</span></a>
<a class="sourceLine" id="cb8-7" title="7"><span class="co">##    AREA PERIMETER CNTY_ CNTY_ID      NAME  FIPS FIPSNO CRESS_ID BIR74 SID74</span></a>
<a class="sourceLine" id="cb8-8" title="8"><span class="co">## 1 0.061     1.231  1827    1827 Alleghany 37005  37005        3   487     0</span></a>
<a class="sourceLine" id="cb8-9" title="9"><span class="co">## 2 0.199     1.984  1874    1874    Wilkes 37193  37193       97  3146     4</span></a>
<a class="sourceLine" id="cb8-10" title="10"><span class="co">## 3 0.081     1.288  1880    1880   Watauga 37189  37189       95  1323     1</span></a>
<a class="sourceLine" id="cb8-11" title="11"><span class="co">##   NWBIR74 BIR79 SID79 NWBIR79                       geometry</span></a>
<a class="sourceLine" id="cb8-12" title="12"><span class="co">## 1      10   542     3      12 MULTIPOLYGON (((1340555 959...</span></a>
<a class="sourceLine" id="cb8-13" title="13"><span class="co">## 2     200  3725     7     222 MULTIPOLYGON (((1402677 837...</span></a>
<a class="sourceLine" id="cb8-14" title="14"><span class="co">## 3      17  1775     1      33 MULTIPOLYGON (((1171158 868...</span></a></code></pre></div>
</div>
<div id="aggregating-or-summarizing-feature-sets" class="section level2">
<h2>Aggregating or summarizing feature sets</h2>
<p>Suppose we want to compare the 1974 fraction of SID (sudden infant death) of the counties that intersect with <code>Ashe</code> to the remaining ones. We can do this by</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" title="1">a &lt;-<span class="st"> </span><span class="kw">aggregate</span>(nc[, <span class="kw">c</span>(<span class="st">&quot;SID74&quot;</span>, <span class="st">&quot;BIR74&quot;</span>)], <span class="kw">list</span>(<span class="dt">Ashe_nb =</span> <span class="kw">lengths</span>(<span class="kw">st_intersects</span>(nc, Ashe)) <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>), sum)</a>
<a class="sourceLine" id="cb9-2" title="2">(a &lt;-<span class="st"> </span>a <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">frac74 =</span> SID74 <span class="op">/</span><span class="st"> </span>BIR74) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(frac74))</a>
<a class="sourceLine" id="cb9-3" title="3"><span class="co">## Simple feature collection with 2 features and 1 field</span></a>
<a class="sourceLine" id="cb9-4" title="4"><span class="co">## Geometry type: GEOMETRY</span></a>
<a class="sourceLine" id="cb9-5" title="5"><span class="co">## Dimension:     XY</span></a>
<a class="sourceLine" id="cb9-6" title="6"><span class="co">## Bounding box:  xmin: 406262.2 ymin: 48374.87 xmax: 3052887 ymax: 1044158</span></a>
<a class="sourceLine" id="cb9-7" title="7"><span class="co">## Projected CRS: NAD83 / North Carolina (ftUS)</span></a>
<a class="sourceLine" id="cb9-8" title="8"><span class="co">##         frac74                       geometry</span></a>
<a class="sourceLine" id="cb9-9" title="9"><span class="co">## 1 0.0020406588 MULTIPOLYGON (((1464961 438...</span></a>
<a class="sourceLine" id="cb9-10" title="10"><span class="co">## 2 0.0009922276 POLYGON ((1166958 888251.7,...</span></a>
<a class="sourceLine" id="cb9-11" title="11"><span class="kw">plot</span>(a[<span class="dv">2</span>], <span class="dt">col =</span> <span class="kw">c</span>(<span class="kw">grey</span>(.<span class="dv">8</span>), <span class="kw">grey</span>(.<span class="dv">5</span>)))</a>
<a class="sourceLine" id="cb9-12" title="12"><span class="kw">plot</span>(<span class="kw">st_geometry</span>(Ashe), <span class="dt">border =</span> <span class="st">&#39;#ff8888&#39;</span>, <span class="dt">add =</span> <span class="ot">TRUE</span>, <span class="dt">lwd =</span> <span class="dv">2</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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uwDqIMAAoK769u176NChJUuWVA5UqFnJyclRUVFHjx7V19evj+0DpXAKEQA048KFC0FBQVu2bOncuXOtNyKRSPh8Pp/PLy0t5fP5ZWVlfD7/+PHj0dHR3t7eGqwWmgAEGABozIkTJ6ZOnfrbb785OjpWe0kmkzGBVFZWVlJSUhlOzM+SkhLmAZvNtrCwsLS0tLKysrS0tLS0tLCw8PT09PX11coRQWOGAAMATfrrr7/mzp3r7e3NNKTKysqYtpRCoWCSycLCwsrKysrKqvJp1SWGhobaPgKgBgIMADTszJkzDx48YMKJaUVZWVmZmJhouy5oahBgAABAJfRCBAAAKiHAAACASggwAACgEgIMAACohAADAAAqIcAAAIBKCDAAAKASAgwAAKiEAAMAACohwAAAgEoIMAAAoBICDAAAqIQAAwAAKiHAAACASggwAACgEgIMAACohAADAAAqIcAAAIBKCDAAAKASAgwAAKiEAAMAACohwAAAgEoIMAAAoBICDAAAqIQAAwAAKiHAAACASggwAACgEgIMAACohAADAAAqIcAAAIBKCDAAAKASAgwAAKiEAAMAACohwAAAgEoIMAAAoBICDAAAqIQAAwAAKiHAAACASggwAACgEgIMAACohAADAAAqIcAAAIBKCDAAAKASAgwAAKiEAAMAACohwAAAgEoIMAAAoBICDAAAqIQAAwAAKiHAAACASggwAACgEgIMAACohAADAAAqIcAAAIBKCDAAAKASAgwAAKiEAAMAACohwAAAgEoIMAAAoBICDAAAqIQAAwAAKiHAAACASggwAACgEgIMAACohAADAAAqIcAAAIBKCDAAAKASAgwAAKiEAAMAACohwAAAgEoIMAAAoBICDAAAqIQAAwAAKiHAAACASggwAACgEgIMAACohAADAAAqIcAAAIBKCDAAAKASAgwAAKiEAAMAACohwAAAgEoIMAAAoBICDAAAqIQAAwAAKiHAAACASggwAACgEgIMAACohAADAAAqIcAAAIBKCDAAAKASAgwAAKiEAAMAACohwAAAgEoIMAAAoBICDAAAqIQAAwAAKiHAAACASggwAACgEgIMAACohAADAAAqIcAAAIBKCDAAAKASAgwAAKiEAAMAACohwAAAgEoIMAAAoBICDAAAqIQAAwAAKiHAAACASggwAACgEgIMAACohAADAAAqIcAAAIBKCDAAAKASAgwAAKiEAAMAACohwAAAgEoIMAAAoBICDAAAqIQAAwAAKiHAAACASggwAACgEgIMAACohAADAAAqIcAAAIBKCDAAAKASAgwAAKiEAAMAACohwAAAgEoIMAAAoBICDAAAqIQAAwAAKiHAAACASggwAACgEgIMAACohAADAAAqIcAAAIBKCDAAAKASAgwAAKiEAAMAACohwAAAgEoIMAAAoBICDAAAqPT/AOOzakESiZ8zAAAAAElFTkSuQmCC" /><!-- --></p>
</div>
<div id="joining-two-feature-sets-based-on-attributes" class="section level2">
<h2>Joining two feature sets based on attributes</h2>
<p>The usual join verbs base R (<code>merge</code>) and of dplyr (<code>left_join</code>, etc) work for <code>sf</code> objects as well; the joining takes place on attributes (ignoring geometries). In case of no matching geometry, an empty geometry is substituted. The second argument should be a <code>data.frame</code> (or similar), not an <code>sf</code> object:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1">x =<span class="st"> </span><span class="kw">st_sf</span>(<span class="dt">a =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>, <span class="dt">geom =</span> <span class="kw">st_sfc</span>(<span class="kw">st_point</span>(<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)), <span class="kw">st_point</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))))</a>
<a class="sourceLine" id="cb10-2" title="2">y =<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">a =</span> <span class="dv">2</span><span class="op">:</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb10-3" title="3"><span class="kw">merge</span>(x, y)</a>
<a class="sourceLine" id="cb10-4" title="4"><span class="co">## Simple feature collection with 1 feature and 1 field</span></a>
<a class="sourceLine" id="cb10-5" title="5"><span class="co">## Geometry type: POINT</span></a>
<a class="sourceLine" id="cb10-6" title="6"><span class="co">## Dimension:     XY</span></a>
<a class="sourceLine" id="cb10-7" title="7"><span class="co">## Bounding box:  xmin: 1 ymin: 1 xmax: 1 ymax: 1</span></a>
<a class="sourceLine" id="cb10-8" title="8"><span class="co">## CRS:           NA</span></a>
<a class="sourceLine" id="cb10-9" title="9"><span class="co">##   a    geometry</span></a>
<a class="sourceLine" id="cb10-10" title="10"><span class="co">## 1 2 POINT (1 1)</span></a>
<a class="sourceLine" id="cb10-11" title="11"><span class="kw">merge</span>(x, y, <span class="dt">all =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb10-12" title="12"><span class="co">## Simple feature collection with 3 features and 1 field (with 1 geometry empty)</span></a>
<a class="sourceLine" id="cb10-13" title="13"><span class="co">## Geometry type: GEOMETRY</span></a>
<a class="sourceLine" id="cb10-14" title="14"><span class="co">## Dimension:     XY</span></a>
<a class="sourceLine" id="cb10-15" title="15"><span class="co">## Bounding box:  xmin: 0 ymin: 0 xmax: 1 ymax: 1</span></a>
<a class="sourceLine" id="cb10-16" title="16"><span class="co">## CRS:           NA</span></a>
<a class="sourceLine" id="cb10-17" title="17"><span class="co">##   a                 geometry</span></a>
<a class="sourceLine" id="cb10-18" title="18"><span class="co">## 1 1              POINT (0 0)</span></a>
<a class="sourceLine" id="cb10-19" title="19"><span class="co">## 2 2              POINT (1 1)</span></a>
<a class="sourceLine" id="cb10-20" title="20"><span class="co">## 3 3 GEOMETRYCOLLECTION EMPTY</span></a>
<a class="sourceLine" id="cb10-21" title="21"><span class="kw">right_join</span>(x, y)</a>
<a class="sourceLine" id="cb10-22" title="22"><span class="co">## Joining, by = &quot;a&quot;</span></a>
<a class="sourceLine" id="cb10-23" title="23"><span class="co">## Simple feature collection with 2 features and 1 field (with 1 geometry empty)</span></a>
<a class="sourceLine" id="cb10-24" title="24"><span class="co">## Geometry type: POINT</span></a>
<a class="sourceLine" id="cb10-25" title="25"><span class="co">## Dimension:     XY</span></a>
<a class="sourceLine" id="cb10-26" title="26"><span class="co">## Bounding box:  xmin: 1 ymin: 1 xmax: 1 ymax: 1</span></a>
<a class="sourceLine" id="cb10-27" title="27"><span class="co">## CRS:           NA</span></a>
<a class="sourceLine" id="cb10-28" title="28"><span class="co">##   a        geom</span></a>
<a class="sourceLine" id="cb10-29" title="29"><span class="co">## 1 2 POINT (1 1)</span></a>
<a class="sourceLine" id="cb10-30" title="30"><span class="co">## 2 3 POINT EMPTY</span></a></code></pre></div>
</div>
<div id="joining-two-feature-sets-based-on-geometries" class="section level2">
<h2>Joining two feature sets based on geometries</h2>
<p>For joining based on spatial intersections (of any kind), <code>st_join</code> is used:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" title="1">x =<span class="st"> </span><span class="kw">st_sf</span>(<span class="dt">a =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>, <span class="dt">geom =</span> <span class="kw">st_sfc</span>(<span class="kw">st_point</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>)), <span class="kw">st_point</span>(<span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>)), <span class="kw">st_point</span>(<span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">3</span>))))</a>
<a class="sourceLine" id="cb11-2" title="2">y =<span class="st"> </span><span class="kw">st_buffer</span>(x, <span class="fl">0.1</span>)</a>
<a class="sourceLine" id="cb11-3" title="3">x =<span class="st"> </span>x[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>,]</a>
<a class="sourceLine" id="cb11-4" title="4">y =<span class="st"> </span>y[<span class="dv">2</span><span class="op">:</span><span class="dv">3</span>,]</a>
<a class="sourceLine" id="cb11-5" title="5"><span class="kw">plot</span>(<span class="kw">st_geometry</span>(x), <span class="dt">xlim =</span> <span class="kw">c</span>(.<span class="dv">5</span>, <span class="fl">3.5</span>))</a>
<a class="sourceLine" id="cb11-6" title="6"><span class="kw">plot</span>(<span class="kw">st_geometry</span>(y), <span class="dt">add =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAkAAAAGwCAMAAAB2PiqAAAAB7FBMVEUMDAwNDQ0PDw8QEBARERESEhITExMUFBQVFRUWFhYYGBgZGRkaGhocHBwdHR0eHh4fHx8gICAjIyMkJCQmJiYpKSkrKyssLCwvLy8wMDAxMTE0NDQ1NTU2NjY3Nzc5OTk6Ojo7Ozs9PT0+Pj4/Pz9BQUFCQkJERERFRUVGRkZHR0dISEhJSUlKSkpLS0tMTExNTU1OTk5PT09SUlJTU1NVVVVYWFhZWVlaWlpcXFxdXV1eXl5fX19hYWFkZGRlZWVmZmZnZ2dpaWlqampra2ttbW1wcHBxcXF1dXV2dnZ3d3d6enp7e3t9fX2BgYGCgoKEhISFhYWIiIiJiYmKioqQkJCTk5OVlZWWlpaXl5eZmZmampqbm5ucnJydnZ2enp6fn5+goKChoaGjo6OlpaWoqKipqamqqqqrq6utra2vr6+wsLCysrKzs7O0tLS1tbW2tra3t7e5ubm6urq8vLy9vb2+vr7AwMDBwcHCwsLDw8PFxcXGxsbHx8fIyMjJycnKysrLy8vMzMzR0dHT09PV1dXW1tbX19fZ2dna2trb29vc3Nze3t7f39/i4uLk5OTl5eXm5ubp6enq6urr6+vt7e3w8PDx8fHy8vLz8/P19fX29vb39/f4+Pj5+fn6+vr7+/v9/f3+/v7///8xCex4AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAG0UlEQVR4nO3b2ZNcdQGG4RCMk0DAEIwQQRBRUVxQiYoLioKyuRFBURFlUQQRFUWNCghoQCQkQbYYIkzmH7UyVmYQO1Un9Vb1OV08z0Wf079z81281TVV3bNhBYINYw9gsQmIREAkAiIREImASAREIiASAZEIiERAJAIiERCJgEgERCIgEgGRCIhEQCQCIhEQiYBIBEQiIBIBkQiIREAkAiIREImASAREIiASAZEIiERAJAIiERCJgEgERCIgEgGRCIhEQCQCIhEQiYBIBEQiIBIBkQiIREAkAiIREImASAREIiASAZEIiERAJAIiERCJgEgERCIgEgGRCIhEQCQCIhEQiYBIBEQiIBIBkQiIREAkAiIREImASAREIiASAZEIiERAJAIiERCJgEgERCIgEgGRCIhEQCQCIhEQiYBIBEQiIBIBkQiIREAkAiIREImASAREIiASAZEIiERAJAIiERCJgEgERCIgEgGRCIhEQCQCIhEQiYBIBEQiIBIBnZTX9nz7yo9e8qkbfvrPsZdMhYBOwrPXLp137W2/+M3dN31i44d+NfaaaRDQYEe+9tbr9x1/c/iucy7eO+aaqRDQUPt2Xn7w9e+Xb91851hbJkRAAz15xi1vPPrb9pvHWDItAhrm4LYZHzcHzv7R/JdMjIAGWX7fN2YdP7X5iTkPmRwBDfKDdy/PPL/9XUfnvGRqBDTEK1sfn/3g6Pk/m++SyRHQEHd++ERP7rtonjsmSEBDfPD1nzMH9r66/ua1Lc/Mfc2kCGiAIxsOrd3/4ZytOzZ+cz2hz39/jEXTIaABHjt3/fa0X66s7L/0K2sHt141xqLpENAA9+xau921+oHz4lvWvkx98JIRBk2IgAa47Qtrt9ufXr28/6HjB385b/57pkRAA9x+5drtjr+uXi784/GDRy6Y/54pEdAAP//Y2u3VNx57fWrp8PGD+z8ywqAJEdAAe89euz1w5vVPP3/Pth+uHdz81TEWTYeABljetP5Djuev2b70gd+vP/v4T0YYNCECGuKK753oycunvjDPIdMjoCEePPdE35l+d9cJHrxZCGiIo++8d/aDw2c+Ot8lkyOgQX637cWZ59d9es5DJkdAw1xz+awfBD1wxpv+33sENMyR9375//8M2rPlkRGmTIuABnrpPZ889Iaju7f8dpQpkyKgoY58cfv//C/h/ive/sRIU6ZEQMP9eseFd73039vlP39p043/GnfONAjoJCzfe9kp53/uuhuuvnTpHd96buw10yCgk/PKn+7Yvfs7DxwYe8dkCIhEQCQCIhEQiYBIBEQiIBIBkQiIREAkAiIREImASAREIiASAZEIiERAJAIiERCJgEgERCIgEgGRCIhEQCQCIhEQiYBIBEQiIBIBkQiIREAkAiIREImASAREIiASAZEIiERAJAIiERCJgEgERCIgEgGRCIhEQCQCIhEQiYBIBEQiIBIBkQiIREAkAiIREImASAREIiASAZEIiERAJAIiERCJgEgERCIgEgGRCIhEQCQCIhEQiYBIBEQiIBIBkQiIREAkAiIREImASAREIiASAZEIiERAJAIiERCJgEgERCIgEgGRCIhEQCQCIhEQiYBIBEQiIBIBkQiIREAkAiIREImASAREIiASAZEIiERAJAIiERCJgEgERCIgEgGRCIhkMQJ6Yd/RsScw2yIEtGfnprOWblkeewazLEBAD59+/8rK3y/6+tg7mGUBArrsjmOvz218eewhzLAAAW3dv3q54OGRdzDLAgT0tmdWLzsfH3kHsyxAQJ/Zfez1yc3/HnsIMyxAQP847aaDh+4768dj72CWBQho5dnPnn7KxQ+NvYKZFiEgJkxAJAIiERCJgEgERCIgEgGRCIhEQCQCIhEQiYBIBEQiIBIBkQiIREAkAiIREImASAREIiASAZEIiERAJAIiERCJgEgERCIgEgGRCIhEQCQCIhEQiYBIBEQiIBIBkQiIREAkAiIREImASAREIiASAZEIiERAJAIiERCJgEgERCIgEgGRCIhEQCQCIhEQiYBIBEQiIBIBkQiIREAkAiIREImASAREIiASAZEIiERAJAIiERCJgEgERCIgEgGRCIhEQCQCIhEQiYBIBEQiIBIBkQiIREAkAiIREImASAREIiASAZEIiERAJAIiERCJgEgERCIgEgGRCIhEQCQCIhEQiYBIBEQiIBIBkQiIREAkAiIREImASAREIiASAZEIiERAJAIiERCJgEgERCIgEgGRCIhEQCQCIhEQiYBIBEQiIBIBkQiIREAkAiIREImASAREIiASAZEIiERAJAIiERCJgEgERCIgkv8ASwyu+DvfGrYAAAAASUVORK5CYII=" /><!-- --></p>
<p>The join method is a left join, retaining all records of the first attribute:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" title="1"><span class="kw">st_join</span>(x, y)</a>
<a class="sourceLine" id="cb12-2" title="2"><span class="co">## Simple feature collection with 2 features and 2 fields</span></a>
<a class="sourceLine" id="cb12-3" title="3"><span class="co">## Geometry type: POINT</span></a>
<a class="sourceLine" id="cb12-4" title="4"><span class="co">## Dimension:     XY</span></a>
<a class="sourceLine" id="cb12-5" title="5"><span class="co">## Bounding box:  xmin: 1 ymin: 1 xmax: 2 ymax: 2</span></a>
<a class="sourceLine" id="cb12-6" title="6"><span class="co">## CRS:           NA</span></a>
<a class="sourceLine" id="cb12-7" title="7"><span class="co">##   a.x a.y        geom</span></a>
<a class="sourceLine" id="cb12-8" title="8"><span class="co">## 1   1  NA POINT (1 1)</span></a>
<a class="sourceLine" id="cb12-9" title="9"><span class="co">## 2   2   2 POINT (2 2)</span></a>
<a class="sourceLine" id="cb12-10" title="10"><span class="kw">st_join</span>(y, x)</a>
<a class="sourceLine" id="cb12-11" title="11"><span class="co">## Simple feature collection with 2 features and 2 fields</span></a>
<a class="sourceLine" id="cb12-12" title="12"><span class="co">## Geometry type: POLYGON</span></a>
<a class="sourceLine" id="cb12-13" title="13"><span class="co">## Dimension:     XY</span></a>
<a class="sourceLine" id="cb12-14" title="14"><span class="co">## Bounding box:  xmin: 1.9 ymin: 1.9 xmax: 3.1 ymax: 3.1</span></a>
<a class="sourceLine" id="cb12-15" title="15"><span class="co">## CRS:           NA</span></a>
<a class="sourceLine" id="cb12-16" title="16"><span class="co">##   a.x a.y                           geom</span></a>
<a class="sourceLine" id="cb12-17" title="17"><span class="co">## 2   2   2 POLYGON ((2.1 2, 2.099863 1...</span></a>
<a class="sourceLine" id="cb12-18" title="18"><span class="co">## 3   3  NA POLYGON ((3.1 3, 3.099863 2...</span></a></code></pre></div>
<p>and the geometry retained is that of the first argument.</p>
<p>The spatial join predicate can be controlled with any function compatible to <code>st_intersects</code> (the default), e.g.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" title="1"><span class="kw">st_join</span>(x, y, <span class="dt">join =</span> st_covers) <span class="co"># no matching y records: points don&#39;t cover circles</span></a>
<a class="sourceLine" id="cb13-2" title="2"><span class="co">## Simple feature collection with 2 features and 2 fields</span></a>
<a class="sourceLine" id="cb13-3" title="3"><span class="co">## Geometry type: POINT</span></a>
<a class="sourceLine" id="cb13-4" title="4"><span class="co">## Dimension:     XY</span></a>
<a class="sourceLine" id="cb13-5" title="5"><span class="co">## Bounding box:  xmin: 1 ymin: 1 xmax: 2 ymax: 2</span></a>
<a class="sourceLine" id="cb13-6" title="6"><span class="co">## CRS:           NA</span></a>
<a class="sourceLine" id="cb13-7" title="7"><span class="co">##   a.x a.y        geom</span></a>
<a class="sourceLine" id="cb13-8" title="8"><span class="co">## 1   1  NA POINT (1 1)</span></a>
<a class="sourceLine" id="cb13-9" title="9"><span class="co">## 2   2  NA POINT (2 2)</span></a>
<a class="sourceLine" id="cb13-10" title="10"><span class="kw">st_join</span>(y, x, <span class="dt">join =</span> st_covers) <span class="co"># matches for those circles covering a point</span></a>
<a class="sourceLine" id="cb13-11" title="11"><span class="co">## Simple feature collection with 2 features and 2 fields</span></a>
<a class="sourceLine" id="cb13-12" title="12"><span class="co">## Geometry type: POLYGON</span></a>
<a class="sourceLine" id="cb13-13" title="13"><span class="co">## Dimension:     XY</span></a>
<a class="sourceLine" id="cb13-14" title="14"><span class="co">## Bounding box:  xmin: 1.9 ymin: 1.9 xmax: 3.1 ymax: 3.1</span></a>
<a class="sourceLine" id="cb13-15" title="15"><span class="co">## CRS:           NA</span></a>
<a class="sourceLine" id="cb13-16" title="16"><span class="co">##   a.x a.y                           geom</span></a>
<a class="sourceLine" id="cb13-17" title="17"><span class="co">## 2   2   2 POLYGON ((2.1 2, 2.099863 1...</span></a>
<a class="sourceLine" id="cb13-18" title="18"><span class="co">## 3   3  NA POLYGON ((3.1 3, 3.099863 2...</span></a></code></pre></div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
